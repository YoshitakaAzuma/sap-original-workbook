## 1問目：API Gateway × Lambda × Aurora

ある国際配送会社は、AWS で配送管理システムを実行しています。システムは、Amazon API Gateway のリージョン API エンドポイントと AWS Lambda 関数を使用する Web アプリケーションで構成されています。Web アプリケーションのコンシューマはすべて、アプリケーションがデプロイされる AWS リージョンの近くにいます。Lambda 関数は、Amazon Aurora MySQL データベースのみをクエリします。ソリューションアーキテクトは、データベースに 3 つのリードレプリカを設定しました。テスト中、アプリケーションはパフォーマンス要件を満たしていましたが、高負荷状態では、アプリケーションは多数のデータベース接続を開きます。ソリューションアーキテクトは、アプリケーションのパフォーマンスを改善する必要があります。ソリューションアーキテクトは、これらの要件を満たすためにどのアクションを実行する必要がありますか。（2 つ選択してください）

- A. Aurora データベースのクラスターエンドポイントを使用します。
- B. RDS Proxy を使用して、Aurora データベースのリーダーエンドポイントの接続プールを設定します。
- C. Lambda プロビジョニング済み同時実行の機能を使用します。
- D. Lambda 関数でデータベース接続を開くためのコードをイベントハンドラの外部に移動します。
- E. API Gateway エンドポイントをエッジ最適化エンドポイントに変更します。

<details>
<summary>答え</summary>
B、D

- クラスターエンドポイントは writer（書き込み）に向けるもの。読み取りには読み取り専用のリーダーエンドポイントを設けてリードレプリカに接続させる。
- Auroraのエンドポイントの違いは以下。
  - https://qiita.com/pensuke628/items/5ca7f2d2a53a71528ad1
- Lambda プロビジョニング済み同時実行とは、常に起動済みの Lambda コンテナを確保しておく機能。コールドスタートをなくして、レスポンスを高速化してくれる。
- 今回の問題はDBの`max_connections`が問題。プロビジョニング済み同時実行はレイテンシの向上なので話が別。

</details>
